## Nginx
nignx是什么？优点？  
https://www.cnblogs.com/xiohao/p/6433401.html  

反向代理  
好吧，之前我也为这个问题纠结挺久，为什么叫反向？既然有反向，那肯定有正向，现有客户端x，代理服务器y，最终服务器z，现在x直接访问z：x->z，通过代理服务器y：x->y->z，无论正反代理服务器y都是位于x、z之间，正反是根据代理服务器代理的是谁来判断的  
正向：**代理服务器y代理的是客户端**，站在客户端的角度上是正向的，所以是正向代理  
反向：**代理服务器y代理的是最终服务器z**，站在客户端的角度上是反向的，所以是反向代理  
好吧，这是我的理解，可能不够详细，这里给大家推荐一片文章，介绍的挺好的：http://bbs.51cto.com/thread-967852-1-1.html    

nginx高性能的原因：得益于它的事件处理机制，**异步非阻塞事件处理机制**：运用了epoll模型，提供了一个队列，排队解决。  

Nginx: 采用单线程来异步非阻塞处理请求（管理员可以配置Nginx主进程的工作进程的数量）(epoll)，不会为每个请求分配cpu和内存资源，节省了大量资源，同时也减少了大量的CPU的上下文切换。所以才使得Nginx支持更高的并发。

#负载均衡
负载均衡即是代理服务器将接收的请求均衡的分发到各服务器中。  
负载均衡主要解决网络拥塞问题，提高服务器响应速度，服务就近提供，达到更好的访问质量，减少后台服务器大并发压力

# Ngnix的几种负载均衡算法
**1.轮循（默认）**

	每个请求按时间顺序逐一分配到不同的后端服务器，如果后端某台服务器宕机，则自动剔除故障机器，使用户访问不受影响。
**2.weight**

	指定轮询权重，weight值越大，分配到的几率就越高，主要用于后端每台服务器性能不均衡的情况。
**3.ip_hash**

	每个请求按访问IP的哈希结果分配，这样每个访客固定访问一个后端服务器，可以有效的解决动态网页存在的session共享问题。  
	但它本身也存在缺陷：  
	1）nginx不是最前端的服务器：ip_hash要求nginx一定是最前端的服务器，否则nginx得不到正确ip，就不能根据ip作hash。譬如使用的是squid（缓冲服务器和代理服务器，有效提高响应	时间为最前端，那么nginx取ip时只能得到squid的服务器ip地址，用这个地址来作分流是肯定错乱的。  
	2）nginx的后端还有其它方式的负载均衡：假如nginx后端又有其它负载均衡，将请求又通过另外的方式分流了，那么某个客户端的请求肯定不能定位到同一台session应用服务器上。  
	3）多个外网出口：很多公司上网有多个出口，多个ip地址，用户访问互联网时候自动切换ip。而且这种情况不在少数。使用 ip_hash 的话对这种情况的用户无效，无法将某个用户绑定在固定的	tomcat上 。
**4.fair（第三方）**

	更智能的一个负载均衡算法，此算法可以根据页面大小和加载时间长短智能地进行负载均衡，也就是根据后端服务器的响应时间来分配请求，响应时间短的优先分配。如果想要使用此调度算法，需要Nginx的upstream_fair模块。
**5.url_hash（第三方）**

	按访问URL的哈希结果来分配请求，使每个URL定向到同一台后端服务器，可以进一步提高后端缓存服务器的效率。如果想要使用此调度算法，需要Nginx的hash软件包。
	
upsteam：用来定义服务器组的模块。upstream中的server用来指定一个服务器。  
**1.weight**:表示权重，权重越大，表示被访问的概率越大

	server 192.168.18.201 weight=4;
**2.max_fails**：表示连接失败重新连接的最多次数

	server 192.168.18.202 max_fails=3;
**3.fail_timeout**:连接超时的时间(即多久算连接失败)

	server 192.168.18.202 max_fails=3 fail_timeout=20s;
**4.backup:**标记一台服务器作为备用服务器(它只在其他服务器繁忙的时候工作)

	server 192.168.18.203 backup;
**5.down:**标记一台服务器下线或者暂时不可用

	server 192.168.18.203 down;
**6.max_conns:**表示指定的服务器最大连接数限制(nginx1.5.9以上版本才有的参数)

	server 192.168.18.202 max_conns=1024;

nginx负载的效率：
Nignx负载均衡功能是通过upstream模块实现的，是基于内容和应用的7层交换负载均衡。Nginx负载均衡默认对后端服务器有健康检测能力，但是检测能力较弱，仅限于端口检测，在后端服务器比较少的情况下（10台及以下）负载均衡能力表现突出。与LVS负载均衡相比，LVS是基于四层的IP负载均衡技术，具有高性能、高可用、吞吐量大等优点，LVS在集群中表现更佳。

## 动静分离
动、静分离将网站静态资源（HTML，JavaScript，CSS，img等文件）与后台应用分开部署，提高用户访问静态代码的速度，降低对后台应用访问。   
这里我们将静态资源放到nginx中，动态资源转发到tomcat服务器中。
	
	location /ncwx-frontend-media {
       alias   D:\\lxnc\\images;
   }

## nginx 和 lvs 的区别
抗负载能力强，因为lvs工作方式的逻辑是非常简单的，而且工作再网络层第4层，仅作请求分发用，没有流量，所以在效率上基本不需要太过考虑。lvs一般很少出现故障。无流量，lvs仅仅分发请求，而流量并不从它本身出去，所以可以利用它这点来做一些线路分流之用。没有流量同时也保住了均衡器的IO性能不会受到大流量的影响。lvs基本上能支持所有应用，因为绿色工作在第4层，所以它可以对几乎所有应用做负载均衡，包括http、数据库、聊天室等。